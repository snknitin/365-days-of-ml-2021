# Day 58 of ML 

## SQL Blocks

In a python project, if you have two sql files with a lot of overlap - Create a base.sql and extend other sql's from this base.sql.

    from jinja2 import FileSystemLoader,Environment

    with open('sql/sql1.sql', 'r') as sql_file:
        sql = sql_file.read()
        # folder where all sqls including base.sql is stored
        template_folder=template_folder=os.path.join(
            os.path.dirname(__file__), 'sql'
        )
        template = Environment(loader=FileSystemLoader(template_folder)).from_string(sql)
        print(template.render())
        
        
base.sql

      select * from temp1;
      {%block part1%} {% endblock part1 %}
      
sql1.sql

      {% extends 'base.sql' %}

      {%block part1%}
      select * from temp2;
      {% endblock part1 %}

**References**
------------
[1] https://stackoverflow.com/questions/62585635/how-to-use-extends-from-base-template-in-python-jinja2-when-writing-sql 
[2] https://github.com/sripathikrishnan/jinjasql
[3]
